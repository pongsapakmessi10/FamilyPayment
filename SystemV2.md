# System V2 - The Family Bank (Multi-tenant Edition)

## ภาพรวมระบบ (System Overview)
เว็บแอปพลิเคชันสำหรับจัดการการเงินในครอบครัวที่รองรับ **หลายครอบครัว (Multi-tenancy)** ช่วยในการบันทึกรายจ่ายกองกลาง, จัดการหนี้สิน, และตั้งเป้าหมายการออมเงิน ข้อมูลของแต่ละครอบครัวจะถูกแยกออกจากกันอย่างชัดเจน พร้อมระบบยืนยันตัวตนที่มีความปลอดภัย

## ฟีเจอร์ใหม่ใน V2 (New Features in V2)

### 1. ระบบยืนยันตัวตน (Authentication)
- **Login/Register**: ระบบสมัครสมาชิกและเข้าสู่ระบบที่ปลอดภัย
- **JWT Security**: ใช้ JSON Web Tokens (JWT) ในการยืนยันตัวตนทุกครั้งที่ใช้งาน
- **User Roles**: แบ่งสิทธิ์ผู้ใช้เป็น 2 ระดับ:
  - **Moderator (หัวหน้าครอบครัว)**: ผู้สร้างครอบครัว, สามารถจัดการรหัสเชิญได้
  - **Member (สมาชิก)**: ผู้เข้าร่วมครอบครัวผ่านรหัสเชิญ

### 2. ระบบหลายครอบครัว (Multi-tenancy)
- **Family Creation**: สร้างพื้นที่ส่วนตัวสำหรับครอบครัวใหม่ได้ทันที
- **Data Isolation**: ข้อมูลธุรกรรม, หนี้สิน, และเป้าหมาย จะถูกแยกตามครอบครัว (Family ID) คนนอกไม่สามารถเห็นข้อมูลได้
- **Invite System**: ระบบรหัสเชิญ (Invite Code) 6 หลัก สำหรับดึงสมาชิกเข้าครอบครัวได้ง่ายๆ

### 3. การตั้งค่าครอบครัว (Family Settings)
- **Manage Invite Code**: หัวหน้าครอบครัวสามารถดูและกดสร้างรหัสเชิญใหม่ (Regenerate) ได้
- **Member List**: ดูรายชื่อสมาชิกทั้งหมดในครอบครัวพร้อมสถานะ

### 4. การอัปเดตแบบเรียลไทม์ที่แม่นยำขึ้น (Scoped Real-time Updates)
- **Family Rooms**: ระบบ Socket.io จะส่งข้อมูลการอัปเดตเฉพาะในห้องของครอบครัวตัวเองเท่านั้น ไม่รบกวนครอบครัวอื่น

---

## ฟีเจอร์หลักจาก V1 (Core Features from V1)

### 1. แดชบอร์ด (Dashboard)
- **สรุปภาพรวม**: แสดงยอดเงินคงเหลือ, รายจ่ายรวมรายเดือน, และเงินออมรวม
- **กราฟแสดงผล**: กราฟวงกลมแสดงสัดส่วนค่าใช้จ่ายแบ่งตามหมวดหมู่
- **ข้อมูลล่าสุด**: ดึงข้อมูลจริงจากฐานข้อมูลของครอบครัวตัวเอง

### 2. ค่าใช้จ่ายกองกลาง (Central Pot / Expenses)
- **บันทึกรายจ่าย**: เพิ่มรายการค่าใช้จ่าย, ระบุคนจ่าย (Payer)
- **รายการย้อนหลัง**: แสดงรายการค่าใช้จ่ายล่าสุด
- **Real-time**: เด้งแจ้งเตือนทันทีเมื่อมีคนในครอบครัวบันทึกรายการ

### 3. ระบบจัดการหนี้สิน (Debt Manager)
- **บันทึกหนี้**: สร้างรายการหนี้สินระหว่างบุคคลในครอบครัว
- **ล้างหนี้ (Clear Debt)**: กดเคลียร์หนี้เมื่อชำระคืนแล้ว
- **Real-time**: สถานะอัปเดตทันที

### 4. กระปุกความฝัน (Dream Jar / Savings)
- **ตั้งเป้าหมาย**: สร้างกระปุกออมเงินสำหรับของที่อยากได้
- **เติมเงิน**: สะสมเงินเข้ากระปุก
- **Progress Bar**: แสดงความคืบหน้าเป้าหมาย

### 5. ระบบเปลี่ยนภาษา (Multi-language Support)
- **TH/EN**: รองรับภาษาไทยและอังกฤษทั้งระบบ
- **Persistence**: จำค่าภาษาที่เลือกไว้

---

## เทคโนโลยีที่ใช้ (Tech Stack)

### Frontend
- **Framework**: Next.js (App Router)
- **Styling**: Tailwind CSS, clsx
- **UI Components**: Framer Motion, Lucide React
- **Charts**: Recharts
- **State/Auth**: React Context API, Axios Interceptors
- **Language**: TypeScript

### Backend
- **Runtime**: Node.js, Express.js
- **Database**: MongoDB, Mongoose ODM
- **Authentication**: JSON Web Tokens (JWT), bcryptjs (Hashing), Cookies
- **Real-time**: Socket.io (with Rooms)

---
*เอกสารฉบับนี้สรุปสถานะระบบ ณ เวอร์ชัน V2 (Multi-tenant)*
